## FIND Null amounts
SELECT * FROM orders WHERE amount is NULL

## COUNT NULLS PER COLUMNS

SELECT COUNT(*) - COUNT(column) FROM table

### REPLACE NULLS with 0 
COALESCE(amount, 0) AS replaced_null

### FIND DUPLICATES
SELECT customer_id, COUNT(*) FROM orders GROUP BY customer_id
HAVING COUNT(*) > 1

## REMOVE duplicates --> keeps latest

WITH cte_duplicates AS(
  SELECT *,
         ROW_NUMBER() OVER( PARTITION BY unique-column) ORDER BY ( SELECT FROM yourTable)
DELETE FROM CTE_duplicates

### TRIM WHITESPACES
TRIM(product_name)
LTRIM(left space)
RTRIM  

## UPPERCASE OR LOWERCASE ALL
UPPER(product_category)

## STANDARDIZE THE DATES
STR_TO_DATE(date_sql, '%m/%d/%y')

# FIXING INVALID DATES
CASE WHEN date_col IS NOT NULL AND date_col != ''  THEN
STR_TO_DATE(date_col , '%Y-%m-%d') 

# cast string to number / if have
CAST(amount_str AS DECIMAL(10,2))

# SPLIT 'First Last' name --> split_part(full_name,'',1)

# Flag negatives --> CASE WHEN amount < 0 THEN 'Error' ELSE 'ok'
                          END

### PANDAS data cleaning 

FILL nulls with mean
df['amount'].fillna(df['amount'].mean())

DROP ROWS with any NULL
df.dropna()

DROP if customer_id IS NUL
df.dropna(subset=['customer_id')]

REMOVE DUPLICATES
df.drop_duplicates()

# DEDUPE by customer
df.drop_duplicates(subset=['customer_id'])

# TRIM strings
df['category'] = df['category'].str.strip()

# Title Case 
df['name'] = df['name].str.title()

# remove non digits -> df['phone]=df['phone'].str.replace(..)
# fix numeric strings  df['amount'] = pd.to_numeric(df['amount'],errors='coerce')

# split_names df[['first','last']] = df['full_name'].str.split(' ',expand=True)

# replace_values df['status'] = df['status'].replace('cancelled','failed')

# Flag negatives df['amount_flag'] = df['amount'].lt(0)
# get data types -> df.dtypes



### SQL find NULL values
SELECT * FROM orders WHERE amount IS NULL

## COUNT NULL
SELECT COUNT(*) - COUNT(column_name) AS null_count FROM tables;

## REPLACE null with values
SELECT COALESCE(amount,0) FROM orders

## fill NULL value with previous values
SELECT amount, COALESCE(amount,LAG(amount) IGNORE NULLS OVER (ORDER BY order_date))

## FIND DUPLICATE ROWS
SELECT customer_id , COUNT(*) FROM orders GROUP BY customer_id
HAVING COUNT(*) > 1

## DELETE DUPLICATE ROWS

with cte as ( SELECT *, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY order_date DESC) rn FROM orders) SELECT *
FROM cte WHERE rn>1


# TRIM WHITESPACE 
SELECT TRIM(product_name) AS new_col FROM orders;

## Standardize date format 
  SELECT TO_DATE(date_str, 'MM/DD/YYYY')


## FIX negative amounts

UPDATE ORDERS SET amount = ABS(amount) WHERE amount < 0;


## RANK orders By amount 
SELECT *, RANK() OVER (ORDER By amount DESC) FROM orders

## ROW number per customer 
SELECT *, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY order_date)

# RUNNING TOTAL
SELECT *, SUM(amount) OVER (ORDER BY order_date) FROM orders;

# Previous order amount
SELECT *, LAG(amount) OVER(ORDER BY order_date) FROM orders;

# NEXT Order amount
SELECT *,LEAD(amount) OVER(ORDER BY order_date) from orders;

## view first 5 rows -- df.head()
## view last 5 rows -- df.tail()
## get shape --> df.shape()
## get column_name --> df.columns
## get data types --> df.dtypes
# summary stats ---> df.describe()
# info about dataframe --> df.info()
# count unique values --> df['category'].unique()
# value counts df['category'.value_counts()
# check for nulls --> df.isnull().sum() 
# fill NULLs with mean --> df['amount'].fillna(df['amount'].mean()
## fill null values with median()
## forwardfill/ recent observation replace
  df['amount'].fillna(method='ffill')
## drop rows with nulls --> df.dropna()
## drop if specific column null --> df.dropna(subset=['customer_id'])
## find duplicates --> df.duplicated().sum()
## Remove Duplicates --> dr.drop_duplicates()
## Dedupe by column --> df.drop_duplicates(subset=['customer_id'], keep='last')

# uppercase --> df['category'] = df['category'].str.upper()
# split columns --> df['first','last'] = df['name'].str.split(' ',expand=True)

## filter --> df[df['amount'] > 1000]
df[df['amount'] >500) & (df['status']="completed")]
df[df['category'].isin('Electronics','Books'])]
df.iloc[0:5, 0:3]
df.loc[df['amount']>1000, ['customer_id','amount']]
df[df['name'].str.contains('John')]
df[df['amount'].notnull()]